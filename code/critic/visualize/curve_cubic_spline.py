from scipy.interpolate import CubicSpline
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.collections import LineCollection
from matplotlib.colors import Normalize
import matplotlib.patches as patches
from mpl_toolkits.axes_grid1.inset_locator import inset_axes, mark_inset

from mplsoccer import Pitch
import io
from PIL import Image

INTERVAL = 10


def fit_cs_curve(x, y):
    """

    @param x: [1,2,3]
    @param y: [3,4,2]
    @return: 
    """
    t = np.linspace(0, 1, len(x))
    spline_x = CubicSpline(t, x)
    spline_y = CubicSpline(t, y)
    t_new = np.linspace(0, 1, INTERVAL*len(x))
    x_val = spline_x(t_new)
    y_val = spline_y(t_new)
    return x, y, x_val, y_val

def fit_cs_curve_ar(ar):
    vals = []
    for i in range(ar.shape[1]):  # (T, N, 2)
        x, y, x_val, y_val = fit_cs_curve(ar[:,i,0].tolist(), ar[:,i,1].tolist())
        vals.append([x_val, y_val])
    vals = np.array(vals)  # (N, 2, 100)
    vals = vals.transpose(2, 0, 1)
    return vals

def fit_cs_curve_df(df):
    vals = []
    df_x = df[['posX.a', 'posX.b', 'posX.c']]
    df_y = df[['posY.a', 'posY.b', 'posY.c']]
    for i in range(len(df)):
        x, y, x_val, y_val = fit_cs_curve(df_x.loc[i].to_list(), df_y.loc[i].to_list())
        vals.append([x_val, y_val])
    vals = np.array(vals)  # 11 * 2 * 100
    return vals


class Visualizer:
    def __init__(self, stripe=False):
        self.pitchLengthX = 105
        self.pitchWidthY = 68
        # pitch_color = 'grass'
        pitch_color = '#B8C0B8'
        line_color = 'white'
        stripe = stripe
        self.pitch = Pitch(pitch_type='custom',
                           pitch_color=pitch_color,
                           line_color=line_color,
                           pitch_length=self.pitchLengthX,
                           pitch_width=self.pitchWidthY,
                           stripe=stripe,
                           axis=False,
                           label=False,
                           tick=False,
                           goal_type='box'
                           )
        self.fig, self.ax = self.pitch.draw(figsize=(16, 10.4))
        self.ax = plt.gca()
        self.marker_kwargs = {'marker': 'o',
                              'markeredgecolor': 'white',
                              'linestyle': 'None'}
        self.marker_kwargs_star = {'marker': 'H',
                                   'markeredgecolor': 'black',
                                   'linestyle': 'None'}
        self.cmap = 'RdYlGn'
        self.linewidth = 5
        self.color = {'off': 'red',
                      'def': 'blue',
                      'ball': 'yellow',
                      'off_pred': 'grey',
                      'def_pred':'blue',
                      'ball_pred': 'yellow'}
        self.cmap = {'off': 'Reds',
                     'def': 'Blues',
                     'ball': 'Yellows',
                     'off_pred': 'Greys',
                     'def_pred':'Blues',
                     'ball_pred': 'Yellows'}
        # self.size = {'off': 10, 'def': 10, 'ball': 8}

    def plot_curves(self, vals, part='off', alpha=1, zorder=5):
        """
        vals: (T, N, 2)
        """
        vals = vals.transpose(1,2,0)
        indices = np.arange(vals.shape[-1])
        norm = Normalize(vmin=indices.min(), vmax=indices.max())
        from matplotlib.colors import LinearSegmentedColormap
        colors = [(1, 1, 0.8), (1, 1, 0.5), (1, 1, 0)]  # 从浅黄色到黄色

        cmap_yellows = LinearSegmentedColormap.from_list("Yellows", colors)
        cmap = cmap_yellows if self.cmap.get(part) == 'Yellows' else plt.get_cmap(self.cmap.get(part))
        print(vals.shape)
        for x_val, y_val in vals:
            points = np.array([x_val, y_val]).T.reshape(-1, 1, 2)  # 转换为 [N, 1, 2]
            segments = np.concatenate([points[:-1], points[1:]], axis=1)  # 构造线段
            n_segments = len(segments)
            # linewidths = np.linspace(3.0, 5.0, n_segments)
            linewidths = np.geomspace(5, 17, n_segments)
            lc = LineCollection(segments, cmap=cmap, linewidths=linewidths, norm=norm, alpha=alpha, zorder=zorder)
            lc.set_array(indices)  # 使用索引作为颜色值
            # lc.set_linewidth(self.linewidth)  # 设置线宽

            self.ax.add_collection(lc)  # 添加 LineCollection 到轴
            # self.ax.autoscale()  # 自动缩放

    def plot_nodes(self, x, y, part='off', alpha=1, zorder=5):
        c = self.color.get(part)
        position, = self.ax.plot(x, y, ms=18, markerfacecolor=c, **self.marker_kwargs, alpha=alpha, zorder=zorder)

    def plot_names(self, x, y, names, roles, initials=False, zorder=10):
        def roles_to_initials(roles):
            return [''.join([word[0] for word in n.split()]) for n in roles]
        def names_to_firstname(names):
            return [n.split()[-1] for n in names]
        text = [self.ax.text(0, 0, '', fontproperties='DejaVu Sans', size=15, zorder=zorder) for i in range(len(x))]
        for j in range(len(x)):
            text[j].set_position([x[j]+0.8, y[j]+0.6])
            text[j].set_text(s=(f'{names_to_firstname(names)[j]}({roles[j] if not initials else roles_to_initials(roles)[j]})'))

    def draw_magnifier(self, left, right, bottom, top, **kwargs):
        # 直接在self.ax上绘制矩形
        rect = patches.Rectangle(
            (left, bottom),
            right - left,
            top - bottom,
            linewidth=2,
            edgecolor=kwargs.get('edgecolor', 'red'),
            facecolor=kwargs.get('facecolor', 'none'),
            linestyle=kwargs.get('linestyle', '--'),
            alpha=kwargs.get('alpha', 1.0)
        )
        self.ax.add_patch(rect)

    @staticmethod
    def show():
        plt.gca().invert_yaxis()
        plt.show()
        plt.gca().invert_yaxis()

    @staticmethod
    def save(path):
        plt.gca().invert_yaxis()
        plt.savefig(path, dpi=600,
                    bbox_inches='tight'
                    )
        plt.gca().invert_yaxis()

    @staticmethod
    def save_to_PILImage():
        plt.gca().invert_yaxis()
        buffer = io.BytesIO()
        plt.savefig(buffer, format='jpg')
        buffer.seek(0)
        pillow_image = Image.open(buffer)
        plt.gca().invert_yaxis()
        return pillow_image

# X = [[[-28.18336, -35.555072, -32.220704, -38.236584, -0.05745600000000195, -28.935664, -13.193303999999998, -48.595976, -31.736048, -11.089728000000001, -42.781240000000004, -49.653928, -34.731184, -25.60524, -30.099544, -23.431976, -40.7638, -22.150984, -10.704920000000001, 0.8647040000000032, -7.733087999999995, -40.203416000000004, 28.583968], [24.12496000000001, 30.41548800000001, -1.923960000000001, -23.521632, -26.566352000000002, 23.000184000000004, 31.413824000000005, 19.790399999999998, 24.06406400000001, -6.589247999999998, -3.1338720000000038, 5.070391999999998, 28.795871999999996, 23.043592000000004, 20.457672000000002, -11.10152, -0.06011200000000372, 6.2217839999999995, 29.503408, -10.416015999999999, -9.096832, 21.838991999999998, 2.1115199999999987]], [[-27.959480000000003, -34.790232, -32.175264, -38.025744, -0.059559999999997615, -28.757664, -13.741695999999997, -48.375672, -31.089639999999996, -10.93886400000001, -42.614224, -49.650384, -34.254088, -25.79952, -29.627807999999998, -23.243136, -40.643888000000004, -21.965184, -11.316536, 0.7203520000000054, -7.544528, -39.899528000000004, 28.640128000000004], [24.614560000000004, 30.531183999999996, -1.7587200000000038, -23.391392, -26.545296, 23.025751999999997, 31.446640000000002, 19.785024000000007, 24.573408000000008, -6.184336000000002, -3.072008000000004, 5.078583999999999, 28.86616, 23.299704, 20.74317599999999, -10.781128000000002, -0.016711999999998284, 6.4321119999999965, 29.565751999999996, -10.0428, -9.203240000000001, 21.782712000000004, 2.187591999999995]], [[-27.71112, -34.01272, -32.123888, -37.801159999999996, -0.05701599999999729, -28.542071999999997, -14.287064, -48.143088, -30.434440000000002, -10.779095999999996, -42.440688, -49.648664, -33.756, -25.939280000000004, -29.136416, -23.04832, -40.512192, -21.759752000000002, -11.916511999999997, 0.5608000000000075, -7.3476479999999995, -39.58808, 28.700975999999997], [25.17, 30.63269600000001, -1.5944960000000066, -23.2702, -26.515656, 23.029031999999994, 31.494327999999996, 19.776136000000008, 25.067575999999995, -5.765384000000001, -3.0165040000000047, 5.0817519999999945, 28.960760000000008, 23.551120000000004, 21.009664, -10.462560000000003, 0.024688000000004706, 6.646703999999993, 29.634719999999994, -9.646248000000003, -9.343464, 21.736936, 2.264944]], [[-27.443599999999996, -33.223888, -32.067368, -37.56356, -0.0496959999999973, -28.287599999999998, -14.822048000000002, -47.89856, -29.774335999999998, -10.610903999999998, -42.259968, -49.648176, -33.239936, -26.020784000000003, -28.629751999999996, -22.847264000000003, -40.367776, -21.532816000000004, -12.496336, 0.38760000000000616, -7.143495999999992, -39.270224, 28.766648000000004], [25.7568, 30.718583999999993, -1.4320799999999991, -23.157984, -26.475344, 23.010272, 31.559023999999994, 19.765408, 25.548448000000008, -5.334352000000003, -2.964376000000005, 5.080424000000001, 29.07672, 23.798055999999995, 21.258031999999993, -10.145528000000002, 0.06712000000000273, 6.866847999999997, 29.714023999999995, -9.22428, -9.511471999999998, 21.702976, 2.342872]], [[-27.155079999999998, -32.424448, -32.006527999999996, -37.313896, -0.037584000000002504, -27.992672000000002, -15.338808, -47.642848, -29.112688, -10.434640000000002, -42.071592, -49.648328, -32.708032, -26.041512, -28.112056, -22.639856, -40.21012, -21.28256, -13.046912000000006, 0.20307999999999993, -6.932959999999994, -38.947176, 28.837159999999997], [26.34456, 30.788815999999997, -1.2721440000000044, -23.054152, -26.423000000000002, 22.970831999999994, 31.642743999999993, 19.754528000000008, 26.018367999999995, -4.893968000000001, -2.9126400000000032, 5.075103999999996, 29.210231999999998, 24.040824, 21.489688, -9.829799999999999, 0.11319200000000507, 7.093607999999996, 29.806903999999996, -8.775551999999998, -9.700855999999998, 21.681576000000007, 2.4206720000000033]], [[-26.837079999999997, -31.614528, -31.942104, -37.053288, -0.020712000000003172, -27.655576000000003, -15.829191999999999, -47.377072, -28.452168, -10.250464000000001, -41.875248, -49.648552, -32.161464, -26.000096000000003, -27.587215999999998, -22.426064000000004, -40.039072, -21.00728, -13.558856000000006, 0.010328000000001225, -6.716607999999994, -38.62012, 28.912431999999995], [26.91060000000001, 30.84474399999999, -1.1151120000000034, -22.957576, -26.35804, 22.913120000000006, 31.747144000000006, 19.745223999999993, 26.479768, -4.447576000000005, -2.858512000000001, 5.066296000000001, 29.356920000000002, 24.279607999999996, 21.706384, -9.515240000000002, 0.16503999999999763, 7.327783999999994, 29.916016, -8.299439999999997, -9.905183999999998, 21.672976000000006, 2.497735999999996]], [[-26.46952, -30.793864000000003, -31.874751999999997, -36.783, 0.0008240000000014902, -27.274936, -16.285064, -47.102664, -27.794648000000002, -10.058391999999998, -41.67088, -49.648368, -31.600671999999996, -25.896544, -27.05872, -22.205952000000003, -39.854879999999994, -20.705583999999998, -14.023184, -0.18692000000000064, -6.494744000000004, -38.290248, 28.992239999999995], [27.44292, 30.888903999999997, -0.9611760000000018, -22.866695999999997, -26.280736, 22.840384000000007, 31.87316, 19.739200000000004, 26.934848000000002, -3.999056000000003, -2.7995440000000045, 5.054535999999999, 29.512, 24.514231999999993, 21.909959999999998, -9.201840000000004, 0.22419999999999618, 7.569839999999999, 30.04317599999999, -7.796271999999998, -10.118255999999999, 21.676904, 2.573592000000005]], [[-26.04056, -29.961959999999998, -31.804984, -36.504328, 0.026959999999995432, -26.849880000000002, -16.698512000000008, -46.821216, -27.14116, -9.858192000000003, -41.458600000000004, -49.647344, -31.025495999999997, -25.732064, -26.529479999999996, -21.979632000000002, -39.658088, -20.376416, -14.431743999999995, -0.38447199999999526, -6.267375999999999, -37.95868, 29.07626400000001], [27.934040000000003, 30.924808, -0.8102799999999988, -22.779624, -26.192136, 22.75647200000001, 32.020808, 19.738175999999996, 27.38516, -3.552631999999999, -2.733719999999998, 5.0404160000000005, 29.670583999999998, 24.743928000000004, 22.102143999999996, -8.889760000000003, 0.291647999999995, 7.819928000000004, 30.18926400000001, -7.267232, -10.334351999999999, 21.692687999999997, 2.647976000000007]], [[-25.54656, -29.118344, -31.7332, -36.218592, 0.05761599999999589, -26.380423999999998, -17.062328, -46.534440000000004, -26.491928, -9.649423999999996, -41.238728, -49.645184, -30.435576, -25.509152, -26.00176, -21.747232000000004, -39.449552, -20.019264, -14.778039999999997, -0.5778879999999944, -6.034256000000006, -37.626456, 29.164112000000003], [28.387080000000005, 30.95660000000001, -0.662232000000003, -22.69424, -26.094016, 22.665440000000004, 32.188976, 19.743831999999998, 27.831328, -3.112727999999997, -2.659600000000001, 5.024632000000004, 29.827839999999995, 24.967183999999996, 22.28435199999999, -8.579367999999999, 0.36774399999999474, 8.077848000000003, 30.354016, -6.714456000000002, -10.548352000000001, 21.719272000000004, 2.7208240000000075]], [[-24.995839999999998, -28.262704, -31.659624, -35.927024, 0.09274399999999616, -25.867568, -17.370176, -46.244032, -25.846424000000003, -9.431464000000005, -41.011736, -49.64164, -29.830552, -25.231303999999994, -25.477064000000002, -21.508872000000004, -39.230288, -19.634088, -15.05767999999999, -0.7626319999999964, -5.794888, -37.294464, 29.255399999999995], [28.805720000000008, 30.988743999999997, -0.516688000000002, -22.608328, -25.988696, 22.571095999999997, 32.375423999999995, 19.757744000000002, 28.272816, -2.683767999999997, -2.576360000000001, 5.007952000000003, 29.979304, 25.181639999999994, 22.457567999999995, -8.271232000000005, 0.452383999999995, 8.343192000000002, 30.536, -6.140879999999999, -10.755768, 21.755352000000002, 2.792264000000003]], [[-24.405359999999995, -27.395104000000003, -31.584368, -35.63072, 0.13231199999999887, -25.31352, -17.617104000000005, -45.951592, -25.203592000000004, -9.203567999999997, -40.778272, -49.636584, -29.210416, -24.903008, -24.956151999999996, -21.264704000000002, -39.001488, -19.221424, -15.269040000000004, -0.9343520000000041, -5.5486800000000045, -36.963456, 29.349784], [29.194560000000003, 31.025624000000008, -0.3732880000000023, -22.519783999999998, -25.878848, 22.476631999999995, 32.576815999999994, 19.781280000000002, 28.707880000000003, -2.2700159999999983, -2.4838159999999974, 4.991191999999998, 30.121080000000006, 25.384192, 22.622239999999998, -7.966111999999999, 0.5449839999999995, 8.615392, 30.732464000000007, -5.550248, -10.952792000000002, 21.799424000000002, 2.862552000000008]], [[-23.79996, -26.516023999999998, -31.507384000000002, -35.330608, 0.17633600000000627, -24.721576, -17.799679999999995, -45.658536, -24.562103999999998, -8.964855999999997, -40.53908, -49.629944, -28.5756, -24.529384, -24.439008, -21.014840000000003, -38.764408, -18.782263999999998, -15.413367999999998, -1.0889919999999975, -5.294960000000003, -36.633992, 29.447063999999997], [29.5548, 31.071303999999998, -0.23170400000000058, -22.426703999999997, -25.767216, 22.384375999999996, 32.788951999999995, 19.815584, 29.1336, -1.875391999999998, -2.3824399999999955, 4.975192, 30.250047999999992, 25.57116, 22.77823199999999, -7.6649119999999975, 0.6446559999999977, 8.893847999999998, 30.939375999999996, -4.946847999999999, -11.136224000000002, 21.849912000000003, 2.9320400000000006]]]
# Y = [[[-23.204919999999998, -25.6264, -31.428552, -35.027456, 0.2248079999999959, -24.096103999999997, -17.916455999999997, -45.366080000000004, -23.920704, -8.714471999999994, -40.295016000000004, -49.621776, -27.927120000000002, -24.116111999999998, -23.924904000000005, -20.759375999999996, -38.520376, -18.318128, -15.495055999999998, -1.2229600000000005, -5.033087999999999, -36.306448, 29.547167999999985], [29.887120000000003, 31.129199999999997, -0.09172800000000336, -22.32752, -25.656423999999998, 22.295536000000006, 33.00701599999999, 19.861455999999997, 29.546144000000005, -1.503319999999995, -2.2733279999999993, 4.960743999999998, 30.363976000000008, 25.738584000000003, 22.924847999999997, -7.3686640000000025, 0.750239999999998, 9.177976000000001, 31.151479999999992, -4.335431999999997, -11.303424, 21.905223999999997, 3.0010879999999958]], [[-22.636360000000003, -24.727535999999997, -31.347624000000003, -34.72184, 0.27771199999999396, -23.442240000000005, -17.967951999999997, -45.075168, -23.278520000000004, -8.451623999999995, -40.046992, -49.612184, -27.266448, -23.669064, -23.41248, -20.498399999999997, -38.270656, -17.830847999999996, -15.521271999999996, -1.3331680000000006, -4.762527999999996, -35.981016000000004, 29.650223999999994], [30.19032, 31.201943999999997, 0.046775999999994156, -22.221111999999998, -25.548712, 22.210231999999998, 33.22592, 19.919336, 29.941080000000014, -1.1566320000000019, -2.1580799999999947, 4.948520000000002, 30.461647999999997, 25.882575999999993, 23.060911999999995, -7.078464000000004, 0.8604879999999966, 9.46736, 31.362560000000002, -3.720927999999997, -11.452184000000003, 21.963815999999994, 3.0700240000000036]], [[-22.09588, -23.821096, -31.264328, -34.4142, 0.3349839999999986, -22.765648, -17.956992, -44.786464, -22.635431999999998, -8.175672000000006, -39.795936, -49.601424, -26.595464, -23.19424, -22.899896000000002, -20.232016, -38.016504, -17.322575999999998, -15.501624000000007, -1.4171600000000026, -4.4829599999999985, -35.657744, 29.756528000000003], [30.46216000000001, 31.291151999999997, 0.18380799999999908, -22.10688, -25.445784, 22.127624000000004, 33.44060800000001, 19.989288000000002, 30.313807999999995, -0.8374479999999949, -2.038711999999993, 4.939016000000002, 30.542839999999984, 25.999736, 23.184872, -6.7954159999999995, 0.9740719999999996, 9.761727999999998, 31.56572, -3.1082800000000006, -11.580784000000001, 22.024256, 3.1390639999999976]], [[-21.579320000000003, -22.908920000000002, -31.178328, -34.104872, 0.39652800000000354, -22.072072000000002, -17.888488000000002, -44.500352, -21.992296, -7.886168000000005, -39.542744, -49.589816, -25.916272000000003, -22.697480000000002, -22.384936, -19.960312000000002, -37.759056, -16.795575999999997, -15.447327999999999, -1.4730320000000034, -4.194295999999994, -35.336552, 29.866552], [30.695080000000004, 31.397415999999993, 0.3192799999999991, -21.98472, -25.348703999999998, 22.0462, 33.646336000000005, 20.071024, 30.659968000000006, -0.547151999999997, -1.9174719999999894, 4.932519999999997, 30.608208000000005, 26.087472000000005, 23.294967999999997, -6.520551999999999, 1.0897279999999938, 10.061016000000002, 31.75384000000001, -2.502192000000001, -11.687871999999999, 22.085279999999997, 3.2083039999999983]], [[-21.07504, -21.992976, -31.089328000000002, -33.794136, 0.4621759999999995, -21.367016, -17.769503999999998, -44.216968, -21.351127999999996, -7.582976000000002, -39.288247999999996, -49.577792, -25.231136000000003, -22.184408, -21.865232000000002, -19.683448, -37.499352, -16.252208000000003, -15.370496000000003, -1.4994960000000006, -3.8967680000000016, -35.01728, 29.980872000000005], [30.89052000000001, 31.520167999999984, 0.4530640000000048, -21.855055999999998, -25.257911999999997, 21.964056000000006, 33.838904000000014, 20.163911999999996, 30.975944, -0.28636000000000195, -1.7966639999999927, 4.929048000000002, 30.65913599999999, 26.144312, 23.389495999999994, -6.254808000000004, 1.2062639999999973, 10.365319999999997, 31.920119999999997, -1.9069760000000002, -11.772528000000001, 22.145799999999994, 3.2776879999999977]], [[-20.558119999999995, -21.075248, -30.997040000000002, -33.482240000000004, 0.5317519999999973, -20.65536, -17.608791999999994, -43.936184, -20.715088, -7.266224000000001, -39.033152, -49.565816, -24.542327999999998, -21.660224, -21.338392, -19.401623999999998, -37.238272, -15.694695999999993, -15.283088, -1.495759999999997, -3.5909359999999992, -34.699704, 30.10017599999999], [31.051119999999997, 31.657719999999998, 0.5851120000000023, -21.718752, -25.17324, 21.879328, 34.01476800000002, 20.267072, 31.259192000000013, -0.054984000000004585, -1.6784479999999888, 4.9284079999999975, 30.69748, 26.170080000000006, 23.467024000000002, -5.998920000000005, 1.322656000000002, 10.674896000000004, 32.05856, -1.326352, -11.834231999999997, 22.204904, 3.34704]], [[-20.008519999999997, -20.157711999999997, -30.901296000000002, -33.16948, 0.6051119999999983, -19.941120000000005, -17.416536, -43.657664, -20.08836, -6.936351999999999, -38.778008, -49.554408, -23.852168, -21.129728, -20.802207999999997, -19.115119999999997, -36.976608, -15.125135999999998, -15.196072000000001, -1.4615599999999986, -3.277712000000001, -34.38356, 30.225176000000005], [31.1704, 31.807183999999978, 0.7154480000000021, -21.577064, -25.094079999999998, 21.790504, 34.17112, 20.379415999999992, 31.508591999999993, 0.1478000000000037, -1.5647039999999919, 4.930207999999993, 30.725280000000012, 26.165960000000005, 23.526663999999997, -5.753392000000002, 1.4380239999999986, 10.990055999999996, 32.1644, -0.7633520000000047, -11.872992, 22.261904, 3.4160559999999975]], [[-19.40656, -19.242231999999994, -30.801992000000002, -32.856208, 0.6822080000000028, -19.227224000000007, -17.203632000000006, -43.380888, -19.475887999999998, -6.594048000000001, -38.523216, -49.544032, -23.163064000000002, -20.597168, -20.254768, -18.824271999999993, -36.714968, -14.545320000000004, -15.118592, -1.3970319999999958, -2.958287999999996, -34.06856, 30.356592000000006], [31.23823999999999, 31.96459999999999, 0.8442560000000014, -21.431496, -25.019496, 21.696752000000004, 34.305864, 20.49972799999999, 31.72461600000001, 0.32339999999999947, -1.456871999999997, 4.933935999999996, 30.744488000000004, 26.134440000000005, 23.568303999999998, -5.518439999999998, 1.5516720000000035, 11.311143999999999, 32.234455999999994, -0.22026400000000024, -11.889232, 22.316296, 3.4843919999999997]]]
# Y = np.array(Y)  # T * 2 * N
# Y = Y.transpose(2, 1, 0)  # N * 2 * T
# Y[:,0,:]+= 52.5  # x
# Y[:,1,:]+= 34  # y

# print(Y.shape)  # 100 * 2 * 11
# vlz = Visualizer()
# vlz.plot_curves(Y[0:1,:,:], part='ball')
# vlz.plot_curves(Y[1:12,:,:], part='off')
# vlz.plot_curves(Y[12:23,:,:], part='def')
# vlz.plot_nodes(Y[0:1, 0, 0], Y[0:1, 1, 0], part='ball', alpha=1)
# vlz.plot_nodes(Y[1:12, 0, 0], Y[1:12, 1, 0], part='off', alpha=1)
# vlz.plot_nodes(Y[12:23, 0, 0], Y[12:23, 1, 0], part='def', alpha=1)
# pi = vlz.save(path='try.png')